<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>å¯¼å‡ºå¼‚å¸¸æµæ°´å·</title>
    <link href="@{'/public/layui-2.5.5/css/layui.css'}" rel="stylesheet" type="text/css"/>
    <style type="text/css">
        body {
            padding: 20px;
        }
    </style>
</head>
<body>
<form class="layui-form layui-form-pane" id="serialNmberForm" method="post" lay-filter="serialNmberForm"
      onsubmit="return false;">
    <div class="layui-form-item">
        <label class="layui-form-label">å¼‚å¸¸ç±»å‹</label>
        <div class="layui-input-inline">
            <select lay-filter="errorType" id="errorType" name="errorStatus"> </select>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">å›½å®¶</label>
        <div class="layui-input-inline">
            <select lay-filter="country" id="country" name="countryId"> </select>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">å¤„ç†çŠ¶æ€</label>
        <div class="layui-input-inline">
            <select lay-filter="dealStatus" id="dealStatus" name="dealStatus"> </select>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">æ”¯ä»˜æ¸ é“</label>
        <div class="layui-input-inline">
            <select lay-filter="payType" id="payType" name="payType"> </select>
        </div>
    </div>
    <div class="layui-form-item">
        <div class="layui-input-block">
            <button class="layui-btn" lay-submit lay-filter="submit">ç«‹å³å¯¼å‡º</button>
            <button type="reset" class="layui-btn layui-btn-primary">é‡ç½®</button>
        </div>
    </div>
</form>
</body>
<script type="text/javascript" src="@{'/public/layui-2.5.5/layui.js'}"></script>
<script type="text/javascript">
    layui.use(['jquery', 'layer', 'form'], function () {
        var $ = layui.$, layer = layui.layer, form = layui.form;
        // å¼‚å¸¸ç±»å‹å¡«å……
        {
            var htm = "<option value=''></option>";
        #{list allErrorStatusTypeMap,as:'n'}
            htm += '<option value = "' + ${n.key} +'">${n.value}</option>';
        #{/list}
            $("#errorType").append(htm);
            form.render();

        }
        // å›½å®¶å¡«å……
        {
            var htm = "<option value=''></option>";
        #{list allCountryUnitMap,as:'n'}
            htm += '<option value = "' + ${n.key} +'">${n.value}</option>';
        #{/list}
            $("#country").append(htm);
            form.render();

        }
        // å¤„ç†çŠ¶æ€å¡«å……
        {
            var htm = "<option value=''></option>";
        #{list allDealStatusTypeMap,as:'n'}
            htm += '<option value = "' + ${n.key} +'">${n.value}</option>';
        #{/list}
            $("#dealStatus").append(htm);
            form.render();

        }
        // æ”¯ä»˜æ¸ é“å¡«å……
        {
            var htm = "<option value=''></option>";
        #{list payTypeMap,as:'n'}
            htm += '<option value = "' + ${n.key} +'">${n.value}</option>';
        #{/list}
            $("#payType").append(htm);
            form.render();

        }

        // è¡¨å•æäº¤ç”¨ajax
        form.on('submit(submit)', function (data) {
            layer.msg('æ‹œæ‰˜è¯·ç­‰ä¸€å“ˆï¼Œæ•°æ®å¯èƒ½æœ‰ç‚¹å¤šğŸ™ƒ', {
                icon: 16
                , shade: 0.01
                , time: 120 * 1000 // æœ€é•¿ç­‰å¾…120ç§’
            });
            $.ajax({
                url: "/FinanceMgr/exportSerialNumber",
                data: data.field,
                type: "post",
                dataType: "json",
                success: function (result) {
                    layer.close(layer.index);
                    layer.open({
                        title: 'æç¤º'
                        , anim: 2
                        ,
                        content: result.success == false ? result.msg == null ? "æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•" : result.msg : result.msg
                        , yes: function () {
                            if (result.obj!=null){
                                window.location.href = result.obj;
                            }
                            layer.close(layer.index);
                        }
                    });
                }
            });
            return false;
        });
    });


</script>
</html>